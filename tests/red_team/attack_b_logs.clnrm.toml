# Attack Vector B: Log Mimicry
# Malicious test that mimics clnrm log output to fake test execution
# Expected: FAIL on missing spans (no OTEL instrumentation)
# First Failing Rule: "expect.span[clnrm.run].existence"

[meta]
name="attack_b_log_mimicry"
version="1.0"
description="Attack vector: Fake clnrm logs without real execution"

[[scenario]]
name="fake_logs"
service="red"
run="sh -lc 'echo \"ðŸš€ Executing test: test_1\"; echo \"âœ… test_1 - PASS (123ms)\"; echo \"Test Results: 1 passed, 0 failed\"; exit 0'"
artifacts.collect=["spans:default"]

[service.red]
plugin="generic_container"
image="alpine:latest"
env={ "ATTACK"="log_mimicry" }

# VALIDATION: Require comprehensive span structure
[[expect.span]]
name="clnrm.run"
kind="internal"
attrs.all={ "result"="pass" }

[[expect.span]]
name="clnrm.step:test_1"
parent="clnrm.run"
events.any=["container.start","container.exec","container.stop"]

# Count validation - must have multiple spans
[expect.counts]
spans_total={ gte=2 }

# This test should FAIL on first span check
